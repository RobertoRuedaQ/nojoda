describe("Enter behavior Jodit Editor Tests",function(){describe("Backspace/Delete key",function(){describe("near empty tag",function(){describe("BR before P",function(){it("Should simple remove BR but cursor should leave inside P",function(){var e=new Jodit(appendTestArea());e.value="<br><p>test</p>";var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.lastChild),t.collapse(!0),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" 2 ")),expect(e.value).to.be.equal("<p> 2 test</p>")})}),describe("Backspace and Previous was empty H1",function(){it("Should simple remove this H1",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<h1></h1><p>test</p>");var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.lastChild),t.collapse(!0),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect(e.value).to.be.equal("<p>test</p>")}),describe("H1 with BR",function(){it("Should simple remove this H1",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<h1><br></h1><p>test</p>");var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.lastChild),t.collapse(!0),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect(e.value).to.be.equal("<p>test</p>")})})}),describe("Delete and next was empty H1",function(){it("Should simple remove this H1",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<p>test</p><h1></h1>");var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.firstChild),t.collapse(!1),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_DELETE,e.editor),expect(e.value).to.be.equal("<p>test</p>")}),describe("H1 with BR",function(){it("Should simple remove this H1",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<p>test</p><h1><br></h1>");var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.firstChild),t.collapse(!1),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_DELETE,e.editor),expect(e.value).to.be.equal("<p>test</p>")})})})}),describe("inside empty TD",function(){it("Should doing nothing",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tbody><tr><td></td></tr></tbody></table>"),e.selection.setCursorIn(e.editor.querySelector("td")),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<table><tbody><tr><td></td></tr></tbody></table>").to.be.equal(e.getEditorValue()),e.selection.focus(),e.selection.insertNode(e.editorDocument.createTextNode(" 2 ")),expect("<table><tbody><tr><td> 2 </td></tr></tbody></table>").to.be.equal(e.getEditorValue())})}),describe("inside empty P",function(){it("Should remove empty tag and set cursor in previous element",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tbody><tr><td></td></tr></tbody></table><p><br></p>");var t=e.editorDocument.createRange();e.selection.focus(),t.selectNodeContents(e.editor.lastChild),t.collapse(!0),e.selection.selectRange(t),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),e.selection.focus(),e.selection.insertNode(e.editorDocument.createTextNode(" 2 ")),expect(e.getEditorValue()).to.be.equal("<table><tbody><tr><td> 2 </td></tr></tbody></table>")})}),describe("Cursor after/before element",function(){describe("Backspace key",function(){it("Should remove that element",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<p><img src="tests/artio.jpg"/>test</p>');var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStartAfter(e.editor.firstChild.firstChild),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<p>test</p>").to.be.equal(e.getEditorValue()),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<p> a test</p>").to.be.equal(e.getEditorValue())})}),describe("Delete key",function(){it("Should remove that element",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<p>test<img src="tests/artio.jpg"/></p>');var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStartBefore(e.editor.querySelector("img")),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_DELETE,e.editor),expect("<p>test</p>").to.be.equal(e.getEditorValue()),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<p>test a </p>").to.be.equal(e.getEditorValue())})})}),describe("Enter backspace in the middle of two UL elements",function(){describe("In first LI of second UL",function(){it("Should connect both UL in one element",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Test</li></ul><ul><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.lastChild.firstChild.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<ul><li>Test</li><li>Some text</li></ul>").to.be.equal(e.getEditorValue()),e.selection.focus(),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<ul><li>Test a </li><li>Some text</li></ul>").to.be.equal(e.getEditorValue())})}),describe("In the P element",function(){it("Should connect both UL in one element",function(){var e=new Jodit(appendTestArea());e.ownerWindow.focus(),e.value="<ul><li>Test</li><li> </li><li>Some text</li></ul>";var t=e.editorDocument.createRange();t.setStart(e.editor.firstChild.childNodes[1],0),t.collapse(!0),e.selection.focus(),e.selection.selectRange(t),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect("<ul><li>Test</li></ul><p><br></p><ul><li>Some text</li></ul>").to.be.equal(e.value),e.selection.focus(),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<ul><li>Test</li><li>Some text</li></ul>").to.be.equal(e.value),e.selection.focus(),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<ul><li>Test a </li><li>Some text</li></ul>").to.be.equal(e.value)})})}),describe("Enter backspace/delete in the start of some LI",function(){describe("in first LI",function(){describe("Enter backspace",function(){it("Should remove this LI and move all conntent in P",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Test</li><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<p>Test</p><ul><li>Some text</li></ul>").to.be.equal(e.getEditorValue()),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<p> a Test</p><ul><li>Some text</li></ul>").to.be.equal(e.getEditorValue())})}),describe("Enter delete",function(){it("Should remove all text content and after this remove that LI",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>"+Jodit.INVISIBLE_SPACE+"</li><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_DELETE,e.editor),expect("<ul><li>Some text</li></ul>").to.be.equal(e.value),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<ul><li> a Some text</li></ul>").to.be.equal(e.value)})})}),describe("in alone LI",function(){it("Should remove this LI and UL and move all conntent in P",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Test</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.childNodes[0].firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<p>Test</p>").to.be.equal(e.getEditorValue()),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect("<p> a Test</p>").to.be.equal(e.getEditorValue())})}),it("Should connect this LI with previous",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Test</li><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.childNodes[1].firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<ul><li>TestSome text</li></ul>").to.be.equal(e.getEditorValue()),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<ul><li>Test a Some text</li></ul>")}),describe("And enter Enter",function(){it("Should split this LI on two again",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Test</li><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.childNodes[1].firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<ul><li>TestSome text</li></ul>").to.be.equal(e.getEditorValue()),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect(e.getEditorValue()).to.be.equal("<ul><li>Test</li><li>Some text</li></ul>")})})}),describe("For non collapsed range",function(){describe("Select part of text inside P element",function(){it("Should remove only selected range",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<p>test</p>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,2),o.setEnd(e.editor.firstChild.firstChild,4),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<p>te</p>").to.be.equal(e.getEditorValue())})}),describe("Select whole text inside element",function(){describe("Inside P",function(){it("Should remove selected range and remove this P",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<p>test</p>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.selectNodeContents(e.editor.firstChild),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("").to.be.equal(e.getEditorValue())})}),describe("Inside table cell",function(){it("Should only remove selected range",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tbody><tr><td>test</td><td>1</td></tr></tbody></table>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.selectNodeContents(e.editor.querySelector("td")),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect("<table><tbody><tr><td></td><td>1</td></tr></tbody></table>").to.be.equal(e.value.replace("<br>",""))})})})})}),describe("Enter key",function(){describe("Enter BR",function(){it("Should simple insert BR element",function(){var e=new Jodit(appendTestArea(),{enter:"BR"});e.value="test",e.selection.setCursorAfter(e.editor.firstChild),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect(e.value).to.be.equal("test<br>"),e.selection.insertHTML("stop"),expect(e.value).to.be.equal("test<br>stop")})}),it("If Enter was pressed in not wrapped text in the end, it text should be wrap in paragraph and cursor should be in next new paragraph",function(){var e=new Jodit(appendTestArea());e.setEditorValue("Some text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,9),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<p>Some text</p><p> a <br></p>")}),describe("If Enter was pressed in the end of SPAN inside P",function(){it("should simple create P and move cursor inside this",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<p>Some <span>text</span></p>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.selectNodeContents(e.editor.firstChild.lastChild),o.collapse(!1),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<p>Some <span>text</span></p><p> a <br></p>")})}),it("If Enter was pressed inside text without wrapper and near were some another elements",function(){var e=new Jodit(appendTestArea());e.setEditorValue('as<span style="color: rgb(147, 101, 184);">da</span>s');var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.nextSibling.firstChild,1),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal('<p>as<span style="color: rgb(147, 101, 184);">d</span></p><p><span style="color: rgb(147, 101, 184);"> a a</span>s</p>')}),it("If Enter was pressed inside H1-6 that should be spliced on two",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<h1>Some text</h1>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,5),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<h1>Some </h1><h1> a text</h1>")}),it("If Enter was pressed inside first empty LI and it was alone LI in UL it should be remove LI and UL and cursor must b inside new P",function(){var e=new Jodit(appendTestArea());e.value="<ul><li> </li></ul>";var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.value).to.be.equal("<p> a <br></p>")}),it("If Enter was pressed inside empty LI it should be removed and cursor must be after UL|OL",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Some text</li><li> </li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.lastChild.firstChild,1),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<ul><li>Some text</li></ul><p> a <br></p>")}),describe("If Enter was pressed inside empty middle LI",function(){it("should split parent UL, remove LI, insert new P in the middle of two new Ul and insert cursor inside this",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Test</li><li> </li><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.childNodes[1],0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<ul><li>Test</li></ul><p> a <br></p><ul><li>Some text</li></ul>")})}),it("If Enter was pressed inside start of first(not empty) LI it should add empty LI and cursor should not move",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<ul><li><br></li><li> a Some text</li></ul>")}),it("If Enter was pressed inside start of first empty LI it should remove this LI, and insert new P element before parent UL, cursor should move to inside it",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<ul><li> </li><li>Some text</li></ul>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<p> a <br></p><ul><li>Some text</li></ul>")}),it("If Enter was pressed inside H1-6 cursor should be move in new paragraph below",function(){var e=new Jodit(appendTestArea());e.value="<h1>Some text</h1>";var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,9),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.value).to.be.equal("<h1>Some text</h1><p> a <br></p>")}),describe("If Enter was pressed",function(){describe("Prevent plugin work",function(){it("Should prevent plugin work",function(){var e=new Jodit(appendTestArea(),{enter:"BR",events:{beforeEnter:function(){return!1}}});e.value="test",e.selection.setCursorAfter(e.editor.firstChild),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect(e.value).to.be.equal("test"),e.selection.insertHTML("stop"),expect(e.value).to.be.equal("teststop")})}),describe("in not wrapped text in the start",function(){it("should wrap this text in paragraph and cursor should be in that, and before should be empty new paragraph",function(){var e=new Jodit(appendTestArea());e.setEditorValue("Some text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<p><br></p><p> a Some text</p>")})})}),it("If Enter was pressed inside empty editor, should be added 2 paragraph and cursor must be in second",function(){var e=new Jodit(appendTestArea());e.setEditorValue(""),e.selection.focus(),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<p><br></p><p> a <br></p>")}),it("If Enter was pressed in no wrapped text, it text should be wrap in paragraph and spliced on two parts",function(){var e=new Jodit(appendTestArea());e.setEditorValue("Some text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,5),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("<p>Some </p><p> a text</p>")}),describe("Content editor after pressing the Enter key",function(){it("Should contain the specified tag settings",function(){var e=new Jodit(appendTestArea());simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect(e.getEditorValue()).to.be.equal("<p><br></p><p><br></p><p><br></p><p><br></p>")}),describe("after this",function(){it("Should contain the specified tag settings and after this cursor must be inside that tag",function(){var e=new Jodit(appendTestArea());e.setEditorValue(""),e.selection.focus(),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("test")),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("test2")),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("test3")),expect("<p><br></p><p>test</p><p>test2</p><p>test3<br></p>").to.be.equal(e.getEditorValue())})})}),describe("Enter pressed inside P element",function(){describe("In the middle of element",function(){it("Should split paragraph",function(){var e=new Jodit(appendTestArea()),t=e.editorDocument.createElement("p"),o=e.editorDocument.createTextNode("Split paragraph");t.appendChild(o),e.selection.insertNode(t);var i=e.editorDocument.createRange();i.setStart(o,6),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(i),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("a ")),expect(e.getEditorValue()).to.be.equal("<p>Split </p><p>a paragraph</p>")}),it("Should create new paragraph with same styles like as original",function(){var e=new Jodit(appendTestArea()),t=e.editorDocument.createElement("p"),o=e.editorDocument.createTextNode("Split paragraph");t.appendChild(o),t.style.textAlign="right",t.style.color="#ff0000",e.selection.insertNode(t);var i=e.editorDocument.createRange();i.setStart(o,6),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(i),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("a ")),expect(sortAtrtibutes(e.getEditorValue())).to.be.equal('<p style="color:#FF0000;text-align:right">Split </p><p style="color:#FF0000;text-align:right">a paragraph</p>')})}),describe("Enter pressed inside P element in the edge",function(){describe("If cursor in the right edge of paragraph after enter",function(){it("should move  cursor in another new paragraph",function(){var e=new Jodit(appendTestArea()),t=e.editorDocument.createElement("p"),o=e.editorDocument.createElement("p");t.innerHTML="Split paragraph",o.innerHTML="Test",e.selection.insertNode(t),e.selection.insertNode(o),e.selection.setCursorIn(t,!1),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("a ")),expect(e.getEditorValue()).to.be.equal("<p>Split paragraph</p><p>a <br></p><p>Test</p>")})}),describe("If cursor in the left edge of paragraph after enter",function(){it("should move cursor in another new paragraph before old place",function(){var e=new Jodit(appendTestArea()),t=e.editorDocument.createElement("p"),o=e.editorDocument.createElement("p");t.innerHTML="Split paragraph",o.innerHTML="Test",e.selection.insertNode(t),e.selection.insertNode(o);var i=e.editorDocument.createRange();i.setStart(t.firstChild,0),i.collapse(!0),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(i),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("a ")),expect(e.getEditorValue()).to.be.equal("<p><br></p><p>a Split paragraph</p><p>Test</p>")})}),describe("Copys styles",function(){it("should move  cursor in new paragraph an copy all styles from old",function(){var e=new Jodit(appendTestArea()),t=e.editorDocument.createElement("p"),o=e.editorDocument.createElement("p");t.style.color="#ff0000",t.style.textAlign="right",t.innerHTML="Split paragraph",o.innerHTML="Test",e.selection.insertNode(t),e.selection.insertNode(o),e.selection.setCursorIn(t,!1),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("a ")),expect(sortAtrtibutes(e.getEditorValue())).to.be.equal('<p style="color:#FF0000;text-align:right">Split paragraph</p><p style="color:#FF0000;text-align:right">a <br></p><p>Test</p>')})})})}),describe("with table",function(){it("If cursor in TD tag",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>text</td></tr></table>");var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.querySelector("td")),t.collapse(!0),e.selection.selectRange(t),e.selection.insertNode(e.editorDocument.createTextNode("split ")),expect(e.value).to.be.equal("<table><tbody><tr><td>split text</td></tr></tbody></table>"),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect(e.getEditorValue()).to.be.equal("<table><tbody><tr><td>split <br>text</td></tr></tbody></table>"),e.selection.insertNode(e.editorDocument.createTextNode(" test ")),expect(e.value).to.be.equal("<table><tbody><tr><td>split <br> test text</td></tr></tbody></table>"),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),expect(e.value).to.be.equal("<table><tbody><tr><td>split <br> test <br>text</td></tr></tbody></table>"),e.selection.insertNode(e.editorDocument.createTextNode(" stop ")),expect(e.value).to.be.equal("<table><tbody><tr><td>split <br> test <br> stop text</td></tr></tbody></table>")}),it("If cursor in right side of table",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>test</td></tr></table>");var t=e.editorDocument.createRange();t.setEndAfter(e.editor.querySelector("table")),t.collapse(!1),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("text"),!1),expect(e.getEditorValue()).to.be.equal("<table><tbody><tr><td>test</td></tr></tbody></table><p>text<br></p>")})}),describe("with SHIFT button",function(){it("should insert <br> tag and move cursor after it.",function(){var e=new Jodit(appendTestArea());e.setEditorValue("test");var t=e.editorDocument.createRange();t.setStart(e.editor.firstChild,2),t.collapse(!0),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor,function(e){e.shiftKey=!0}),e.selection.insertNode(e.editorDocument.createTextNode("split ")),expect(e.getEditorValue()).to.be.equal("te<br>split st"),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor,function(e){e.shiftKey=!0}),expect(e.getEditorValue()).to.be.equal("te<br>split <br>st")})}),describe("In PRE tag",function(){it("Should add <br> element",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<pre>test</pre>"),e.selection.setCursorIn(e.editor.querySelector("pre"),!1),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("split")),expect("<pre>test<br>split</pre>").to.be.equal(sortAtrtibutes(e.getEditorValue()))})}),describe("In UL tag",function(){describe("enter mode = br",function(){describe("Inside LI tag in the end",function(){it("Should work like usual and add new LI element",function(){var e=new Jodit(appendTestArea(),{enter:"BR"});e.value="<ul><li>test</li></ul>",e.selection.setCursorAfter(e.editor.querySelector("ul>li").firstChild),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("split")),expect("<ul><li>test</li><li>split<br></li></ul>").to.be.equal(sortAtrtibutes(e.value))})}),describe("Inside empty LI tag",function(){it("Should work like usual and add insert new br after UL",function(){var e=new Jodit(appendTestArea(),{enter:"BR"});e.value="<ul><li>test</li><li> </li></ul>",e.selection.setCursorAfter(e.editor.querySelectorAll("ul>li")[1].firstChild),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("split")),expect("<ul><li>test</li></ul>split<br>").to.be.equal(sortAtrtibutes(e.value))})})}),describe("In LI tag inside table cell",function(){it("Should work like usual",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tbody><tr><td><ul><li>test</li></ul></td></tr></tbody></table>"),e.selection.setCursorIn(e.editor.querySelector("ul>li"),!1),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("split")),expect("<table><tbody><tr><td><ul><li>test</li><li>split<br></li></ul></td></tr></tbody></table>").to.be.equal(sortAtrtibutes(e.getEditorValue()))})}),describe("In last LI tag",function(){describe("In tag was only one Image element but cursor was before it",function(){it("Should not add new P element and move image there",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<ul><li>1</li><li>2</li><li><img style="width:30px" src="tests/artio.jpg"></li></ul>'),e.selection.setCursorBefore(e.editor.firstChild.lastChild.firstChild),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("split ")),expect('<ul><li>1</li><li>2</li><li><br></li><li>split <img src="tests/artio.jpg" style="width:30px"></li></ul>').to.be.equal(sortAtrtibutes(e.getEditorValue()))})})})}),describe("Use BR instead P",function(){describe("Enter 3 times",function(){it("should create 3 BR elements and set cursor after these",function(){var e=new Jodit(appendTestArea(),{enter:Jodit.BR});e.setEditorValue("Some text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,9),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.be.equal("Some text<br><br><br> a ")})})}),describe("Press Enter inside SPAN with some color",function(){it("Should add new P element after this span and this SPAN sholud wrap in P",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<span style="color:red">test</span>'),e.selection.setCursorIn(e.editor.querySelector("span"),!1),simulateEvent("keydown",Jodit.KEY_ENTER,e.editor),e.selection.insertNode(e.editorDocument.createTextNode("test")),expect('<p><span style="color:red">test</span></p><p>test<br></p>').to.be.equal(sortAtrtibutes(e.getEditorValue()))})})}),afterEach(removeStuff)});