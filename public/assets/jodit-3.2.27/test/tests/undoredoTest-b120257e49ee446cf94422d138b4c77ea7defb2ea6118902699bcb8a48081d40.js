describe("Undo/Redo behaviors",function(){describe("Do some changes",function(){it("Should change redo/undo stack",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("test");var t=e.editorDocument.createRange();t.setEnd(e.editor.firstChild,4),t.collapse(!1),e.selection.selectRange(t),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-paragraph"));var o=e.container.querySelector(".jodit_toolbar_list");simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-h1")),expect(e.value).to.be.equal("<h1>test</h1>"),e.execCommand("undo"),expect(e.value).to.be.equal("test"),e.execCommand("redo"),expect(e.value).to.be.equal("<h1>test</h1>")}),describe("Several oprations",function(){it("Should work perfect",function(){var e=new Jodit(appendTestArea());e.value="<p>test</p><ul><li>test2</li><li>test3</li><li><a>test4</a></li></ul>";var t=e.editorDocument.createRange();t.setStart(e.editor.firstChild.firstChild,1),t.setEnd(e.editor.lastChild.firstChild,1),e.selection.selectRange(t),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect(e.value).to.be.equal("<p>t</p><ul><li>test3</li><li><a>test4</a></li></ul>"),e.execCommand("undo"),expect(e.value).to.be.equal("<p>test</p><ul><li>test2</li><li>test3</li><li><a>test4</a></li></ul>"),t.setStart(e.editor.firstChild.firstChild,0),t.setEnd(e.editor.firstChild.firstChild,3),e.selection.selectRange(t),simulateEvent("keydown",Jodit.KEY_BACKSPACE,e.editor),expect(e.value).to.be.equal("<p>t</p><ul><li>test2</li><li>test3</li><li><a>test4</a></li></ul>"),e.execCommand("undo"),expect(e.value).to.be.equal("<p>test</p><ul><li>test2</li><li>test3</li><li><a>test4</a></li></ul>")})})}),describe("Commands",function(){it('Undo. Enter text wait and again enter text. After execute "undo" command. First text should be returned',function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("test"),e.setEditorValue("test2"),e.execCommand("undo"),expect(e.getEditorValue()).to.equal("test")}),it('Redo. Enter text wait and again enter text. After execute "undo" + "redo" command in editor should be second text',function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("test"),e.setEditorValue("test2"),e.execCommand("undo"),expect(e.getEditorValue()).to.equal("test"),e.execCommand("redo"),expect(e.getEditorValue()).to.equal("test2")}),it("Check react UndoRedo to another changes",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("test");var t=e.editorDocument.createRange();t.setEnd(e.editor.firstChild,4),t.collapse(!1),e.editorWindow.getSelection().removeAllRanges(),e.editorWindow.getSelection().addRange(t),e.selection.insertNode(e.editorDocument.createTextNode("test2")),e.execCommand("undo"),expect(e.getEditorValue()).to.equal("test"),e.execCommand("redo"),expect(e.getEditorValue()).to.equal("testtest2")})}),describe("Clear stack",function(){it("Should disable both buttons in toolbar and all calls redo and undo must do nothing",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,observer:{timeout:0}}),t=e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-undo");expect(t).to.be.not.equal(null);var o=e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-redo");expect(o).to.be.not.equal(null),expect(t.classList.contains("jodit_disabled")).to.be["true"],expect(o.classList.contains("jodit_disabled")).to.be["true"],e.value="test",e.value="stop",expect(t.classList.contains("jodit_disabled")).to.be["false"],expect(o.classList.contains("jodit_disabled")).to.be["true"],simulateEvent("mousedown",0,t),expect(e.value).to.be.equal("test"),expect(t.classList.contains("jodit_disabled")).to.be["false"],expect(o.classList.contains("jodit_disabled")).to.be["false"],simulateEvent("mousedown",0,o),expect(e.value).to.be.equal("stop"),expect(t.classList.contains("jodit_disabled")).to.be["false"],expect(o.classList.contains("jodit_disabled")).to.be["true"],e.observer.clear(),expect(t.classList.contains("jodit_disabled")).to.be["true"],expect(o.classList.contains("jodit_disabled")).to.be["true"],expect(e.value).to.be.equal("stop"),e.execCommand("undo"),expect(t.classList.contains("jodit_disabled")).to.be["true"],expect(o.classList.contains("jodit_disabled")).to.be["true"],expect(e.value).to.be.equal("stop")})}),afterEach(removeStuff)});