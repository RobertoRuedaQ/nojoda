describe("Test states",function(){describe("ReadOnly",function(){describe("Set readonly mode in options",function(){describe("For iframe",function(){it("Should deny edit content in iframe's body",function(e){unmocPromise();var t=new Jodit(appendTestArea(),{readonly:!0,iframe:!0,events:{afterConstructor:function(){expect(!1).to.equal(t.editor.hasAttribute("contenteditable")),expect("BODY").to.equal(t.editor.nodeName),e()}}})})}),it("Should deny edit content in wysiwyg",function(){var e=new Jodit(appendTestArea(),{readonly:!0});expect(!1).to.equal(e.editor.hasAttribute("contenteditable"))}),it("Should deny exec any commands",function(){var e=new Jodit(appendTestArea(),{readonly:!0});e.setEditorValue("test"),e.selection.select(e.editor.firstChild),e.execCommand("bold"),expect("test").to.equal(e.getEditorValue())}),it("Should disable all toolbar buttons besides source, print, about, fullsize",function(){var e=new Jodit(appendTestArea(),{readonly:!0,toolbarAdaptive:!1,observer:{timeout:0}});e.setEditorValue("test"),[].slice.call(e.container.querySelectorAll(".jodit_toolbar_btn")).forEach(function(e){/(source|print|about|fullsize|separator|selectall|break)/.test(e.className)||(expect(!0).to.be.equal(e.classList.contains("jodit_disabled")),expect(!0).to.be.equal(e.hasAttribute("disabled")))})}),it("Should deny edit content in simple source editor",function(){var e=new Jodit(appendTestArea(),{readonly:!0,useAceEditor:!1});e.setMode(Jodit.MODE_SOURCE),expect(!0).to.equal(e.__plugins.source.mirror.hasAttribute("readonly"))}),it("Should deny edit content in ace source editor",function(e){var t=new Jodit(appendTestArea(),{readonly:!0,useAceEditor:!0,events:{aceInited:function(t){expect(null).to.be.not.equal(t.__plugins.source.aceEditor),expect(!0).to.be.equal(t.__plugins.source.aceEditor.getReadOnly()),e()}}});t.setMode(Jodit.MODE_SOURCE),expect(!0).to.be.equal(t.__plugins.source.mirror.hasAttribute("readonly"))}).timeout(6e3),it("Should hide placeholder",function(){var e=appendTestArea();e.value="";var t=new Jodit(e,{readonly:!0});expect(t.container.querySelectorAll(".jodit_placeholder").length&&"none"===t.container.querySelector(".jodit_placeholder").style.display).to.be.equal(!0),t.setEditorValue("test"),expect(t.container.querySelectorAll(".jodit_placeholder").length&&"none"===t.container.querySelector(".jodit_placeholder").style.display).to.be.equal(!0)}),describe("Search plugin",function(){describe("CTRL + H",function(){describe("In readonly editor",function(){it("Should be deny",function(){var e=new Jodit(appendTestArea(),{readonly:!0,observer:{timeout:0}}),t=e.container.querySelector(".jodit_search");expect(!1).to.equal(t.classList.contains("jodit_search-active")),simulateEvent("keydown",Jodit.KEY_H,e.editor,function(e){e.ctrlKey=!0}),expect(!1).to.equal(t.classList.contains("jodit_search-active")),expect(!1).to.equal(t.classList.contains("jodit_search-and-replace")),expect(!1).to.equal(e.ownerDocument.activeElement===t.querySelector(".jodit_search-query"))})})})}),describe("Method get read only",function(){it("Should return enable/disable readonly",function(){var e=new Jodit(appendTestArea(),{readonly:!0});expect(!0).to.equal(e.getReadOnly()),e.setReadOnly(!1),expect(!1).to.equal(e.getReadOnly()),e.destruct();e=new Jodit(appendTestArea());expect(!1).to.equal(e.getReadOnly())})})}),describe("Set readonly mode by source element attribute",function(){it("Should work like by options",function(){var e=appendTestArea();e.setAttribute("readonly","true");var t=new Jodit(e);expect(t.editor.hasAttribute("contenteditable")).to.be["false"],expect(t.getReadOnly()).to.be["true"]}),describe("In short form",function(){it("Should work like by options",function(){var e=appendTestArea();e.setAttribute("readonly","");var t=new Jodit(e);expect(t.editor.hasAttribute("contenteditable")).to.be["false"],expect(t.getReadOnly()).to.be["true"]})})}),describe("Disable readonly mode",function(){it("Should allow edit content in wysiwyg",function(){var e=new Jodit(appendTestArea(),{readonly:!0});expect(!1).to.equal(e.editor.hasAttribute("contenteditable")),e.setReadOnly(!1),expect(!0).to.equal(e.editor.hasAttribute("contenteditable"))}),it("Should allow edit content in simple source editor",function(){var e=new Jodit(appendTestArea(),{readonly:!0,useAceEditor:!1});e.setMode(Jodit.MODE_SOURCE),expect(!0).to.equal(e.__plugins.source.mirror.hasAttribute("readonly")),e.setReadOnly(!1),expect(!1).to.equal(e.__plugins.source.mirror.hasAttribute("readonly"))}),it("Should allow edit content in ace source editor",function(e){var t=new Jodit(appendTestArea(),{readonly:!0,useAceEditor:!0,defaultMode:Jodit.MODE_SOURCE,events:{aceInited:function(t){expect(null).to.be.not.equal(t.__plugins.source.aceEditor),expect(!0).to.be.equal(t.__plugins.source.aceEditor.getReadOnly()),t.setReadOnly(!1),expect(!1).to.be.equal(t.__plugins.source.mirror.hasAttribute("readonly")),expect(!1).to.be.equal(t.__plugins.source.aceEditor.getReadOnly()),e()}}});t.setMode(Jodit.MODE_SOURCE),expect(!0).to.be.equal(t.__plugins.source.mirror.hasAttribute("readonly"))}).timeout(6e3)})}),describe("Disabled",function(){describe("Set disabled mode in options",function(){it("Should enable readonly mode too and editor's container should have jodit_disabled class",function(){var e=appendTestArea();e.setAttribute("disabled","true");var t=new Jodit(e);expect(t.container.classList.contains("jodit_disabled")).to.be["true"],expect(t.editor.hasAttribute("contenteditable")).to.be["false"],expect(t.getReadOnly()).to.be["true"],expect(t.getDisabled()).to.be["true"]})}),describe("Switch disabled mode",function(){it("Should enable readonly if true but set default readonly mode in false",function(){var e=appendTestArea();e.setAttribute("disabled","true"),e.setAttribute("readonly","true");var t=new Jodit(e);expect(t.getReadOnly()).to.be["true"],expect(t.getDisabled()).to.be["true"],t.setDisabled(!1),expect(t.getReadOnly()).to.be["true"],expect(t.getDisabled()).to.be["false"]})})}),afterEach(removeStuff)});