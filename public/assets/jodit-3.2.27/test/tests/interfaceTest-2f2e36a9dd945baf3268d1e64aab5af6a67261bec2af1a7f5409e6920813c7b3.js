describe("Test interface",function(){describe("Toolbar",function(){describe("Set toolbar options to false",function(){it("Should hide toolbar",function(){var e=new Jodit(appendTestArea(),{toolbar:!1});expect(null).to.be.equal(e.container.querySelector("jodit_toolbar"))})}),describe("Popups",function(){describe("Click on dots buttons in mobile size",function(){it("Should open popup with several buttons",function(){getBox().style.width="300px";var e=new Jodit(appendTestArea()).container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-dots");expect(e).to.be.not.equal(null),simulateEvent("mousedown",0,e);var t=e.querySelector(".jodit_toolbar_popup.jodit_toolbar_popup-open");expect(t).to.be.not.equal(null);var o=t.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-video");expect(o).to.be.not.equal(null),simulateEvent("mousedown",0,o);var n=o.querySelector(".jodit_toolbar_popup.jodit_toolbar_popup-open");expect(n).to.be.not.equal(null),getBox().style.width="auto"}),describe("Some with touchend",function(){it("Should open popup with several buttons",function(){getBox().style.width="300px";var e=new Jodit(appendTestArea()).container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-dots");expect(e).to.be.not.equal(null),simulateEvent("touchend",0,e);var t=e.querySelector(".jodit_toolbar_popup.jodit_toolbar_popup-open");expect(t).to.be.not.equal(null);var o=t.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-video");expect(o).to.be.not.equal(null),simulateEvent("touchend",0,o);var n=o.querySelector(".jodit_toolbar_popup.jodit_toolbar_popup-open");expect(n).to.be.not.equal(null),getBox().style.width="auto"})})}),describe("Click on some link",function(){describe("in the left side of editor",function(){it("Should open inline popup with float by left editor side",function(){var e=new Jodit(appendTestArea(),{});e.setEditorValue('asas <a href="#">test</a>'),simulateEvent("mousedown",0,e.editor.querySelector("a"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline.jodit_toolbar_popup-inline-open");expect(t&&"none"!==t.style.display).to.be.equal(!0);var o=offset(t),n=offset(e.container);expect(!0).to.be.equal(o.left>=n.left)})})}),describe("Click on some button with defined popup field",function(){it("Should open popup in toolbar",function(){var e=new Jodit(appendTestArea(),{disablePlugins:"mobile"});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-video"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup");expect(t&&"block"===t.style.display).to.equal(!0)}),describe("in the left side",function(){it("Should open popup in toolbar with float by left editor side",function(){var e=new Jodit(appendTestArea(),{buttons:["video"],disablePlugins:"mobile"});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-video"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup[data-editor_id="+e.id+"]");expect(t).to.be.not.equal(null);var o=offset(t),n=offset(e.container);expect(!0).to.be.equal(o.left>=n.left)})}),describe("in the right side",function(){it("Should open popup in toolbar with float by left editor side",function(){var e=new Jodit(appendTestArea(),{width:300,buttons:["video","video","video","video","video","video","video","video","video"],disablePlugins:"mobile"});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-video:last-child"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup[data-editor_id="+e.id+"]");expect(t).to.be.not.equal(null);var o=offset(t),n=offset(e.container);expect(Math.abs(o.left+o.width-(n.left+n.width))<2).to.be["true"]})})}),getBox().style.width="auto",it("Open and close popap after clicking in another place",function(){var e=new Jodit(appendTestArea(),{disablePlugins:"mobile"});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-video"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup");expect(t&&"block"===t.style.display).to.equal(!0),simulateEvent("mousedown",0,window),expect(t&&null===t.parentNode).to.equal(!0)}),describe("Open list",function(){it("Should Open list in toolbar",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_with_dropdownlist.jodit_toolbar_btn-font"));var t=e.container.querySelector(".jodit_toolbar_list");expect(t&&"block"===window.getComputedStyle(t).display&&null!==t.parentNode).to.equal(!0)}),describe("Change defaiult list",function(){it("Should change default FONT list in toolbar",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,controls:{font:{list:{"font-family: -apple-system,BlinkMacSystemFont,Segoe WPC,Segoe UI,HelveticaNeue-Light,Ubuntu,Droid Sans,sans-serif;":"Custom","Helvetica,sans-serif":"Helvetica","Arial,Helvetica,sans-serif":"Arial","Georgia,serif":"Georgia","Impact,Charcoal,sans-serif":"Impact","Tahoma,Geneva,sans-serif":"Tahoma","'Times New Roman',Times,serif":"Times New Roman","Verdana,Geneva,sans-serif":"Verdana"}}}});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_with_dropdownlist.jodit_toolbar_btn-font"));var t=e.container.querySelector(".jodit_toolbar_list");expect(t&&"block"===window.getComputedStyle(t).display&&null!==t.parentNode).to.equal(!0),expect(t.innerText.match("Custom")).to.be.not.equal(null)}),it("Should change default FONT size list in toolbar",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,controls:{fontsize:{list:"8,9,10"}}});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_with_dropdownlist.jodit_toolbar_btn-fontsize"));var t=e.container.querySelector(".jodit_toolbar_list");expect(t.getElementsByTagName("li").length).to.be.equal(3)})})}),it("Open and close list after clicking in another place",function(){var e=new Jodit(appendTestArea());simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_with_dropdownlist"));var t=e.container.querySelector(".jodit_toolbar_list");expect(t&&"block"===window.getComputedStyle(t).display).to.equal(!0),simulateEvent("mousedown",0,window),expect(t&&null===t.parentNode).to.equal(!0)}),it("Open colorpicker set background and color. After this click in another any place. White when popap will be closed. Open again and remove all styles.",function(){var e=new Jodit(appendTestArea());e.setEditorValue("text2text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,3),o.setEnd(e.editor.firstChild,6),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-brush"));var n=e.container.querySelector(".jodit_toolbar_popup");expect(window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,e.container.querySelector('.jodit_toolbar_btn.jodit_toolbar_btn-brush [data-color="#F9CB9C"]')),expect(e.getEditorValue()).to.equal('tex<span style="background-color: rgb(249, 203, 156);">t2t</span>ext'),expect(n.parentNode).to.equal(null),o.selectNodeContents(e.editor.querySelector("span")),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-brush")),n=e.container.querySelector(".jodit_toolbar_popup.jodit_toolbar_popup-open"),expect(window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-brush .jodit_colorpicker > a > svg")),expect(e.getEditorValue()).to.equal("text2text")}),it("Open format list set H1 for current cursor position. Restore selection after that",function(){var e=new Jodit(appendTestArea());e.setEditorValue("text2text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,3),o.setEnd(e.editor.firstChild,6),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-paragraph"));var n=e.container.querySelector(".jodit_toolbar_list");expect(window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-paragraph .jodit_toolbar_btn.jodit_toolbar_btn-h1")),expect(e.getEditorValue()).to.equal("<h1>text2text</h1>"),simulateEvent("mousedown",0,e.editor),expect(n.parentNode).to.equal(null),e.selection.insertNode(e.editorDocument.createTextNode(" a ")),expect(e.getEditorValue()).to.equal("<h1>tex a ext</h1>")}),describe("FontName",function(){describe("Open fontname list and select some element",function(){it("Should apply this font to current selection elements",function(){function e(){return simulateEvent("mousedown",0,o),o.querySelector(".jodit_toolbar_list.jodit_toolbar_list-open > ul")}var t=new Jodit(appendTestArea(),{toolbarAdaptive:!1});t.value="<p>test</p>",t.selection.select(t.editor.firstChild.firstChild);var o=t.container.querySelector(".jodit_toolbar_btn.jodit_with_dropdownlist.jodit_toolbar_btn-font");expect(o).to.be.not.equal(null),expect(e()).to.be.not.equal(null),[].slice.call(e().childNodes).forEach(function(o,n){o=e().childNodes[n],simulateEvent("mousedown",0,o);var i=o.querySelector("span[style]").getAttribute("style").replace(/"/g,"'");expect(sortAtrtibutes(t.value)).to.be.equal(sortAtrtibutes('<p><span style="'+i+'">test</span></p>'))})}),describe("Extends standart font list",function(){it("Should standart font list elements",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,controls:{font:{list:{"-apple-system,BlinkMacSystemFont,'Segoe WPC','Segoe UI',HelveticaNeue-Light,Ubuntu,'Droid Sans',sans-serif":"OS System Font"}}}});e.value="<p>test</p>",e.selection.select(e.editor.firstChild.firstChild);var t=e.container.querySelector(".jodit_toolbar_btn.jodit_with_dropdownlist.jodit_toolbar_btn-font");expect(t).to.be.not.equal(null),simulateEvent("mousedown",0,t);var o=t.querySelector(".jodit_toolbar_list.jodit_toolbar_list-open > ul");expect(o).to.be.not.equal(null);var n=o.childNodes[o.childNodes.length-1];simulateEvent("mousedown",0,n),expect(sortAtrtibutes(e.value)).to.be.equal(sortAtrtibutes("<p><span style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe WPC','Segoe UI',HelveticaNeue-Light,Ubuntu,'Droid Sans',sans-serif\">test</span></p>"))})})})}),it("Open image dialog and insert image by url.",function(){var e=new Jodit(appendTestArea());e.setEditorValue(Jodit.INVISIBLE_SPACE);var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.selectNodeContents(e.editor),o.collapse(!1),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image"));var n=e.container.querySelector(".jodit_toolbar_popup");expect(window.getComputedStyle(n).display).to.equal("block"),e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image input[name=url]").value="",e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image input[name=text]").value="123",simulateEvent("submit",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image .jodit_form")),expect(e.container.querySelectorAll(".jodit_toolbar_btn.jodit_toolbar_btn-image input[name=url].jodit_error").length).to.equal(1),e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image input[name=url]").value="http://xdsoft.net/jodit/images/artio.jpg",simulateEvent("submit",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image .jodit_form")),expect(sortAtrtibutes(e.getEditorValue())).to.equal('<img alt="123" src="http://xdsoft.net/jodit/images/artio.jpg">'),simulateEvent("mousedown",0,e.editor),expect(n.parentNode).to.equal(null)}),it("Open video dialog and insert video by url from youtube.",function(){var e=new Jodit(appendTestArea(),{disablePlugins:"mobile"});e.value="",simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-video"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup");expect(t.style.display).to.equal("block"),t.querySelector("input[name=code]").value="sddhttps://www.youtube.com/watch?v=7CcEYRfxUOQ",simulateEvent("submit",0,t.querySelector(".jodit_form")),expect(t.querySelectorAll("input[name=code].jodit_error").length).to.equal(1),t.querySelector("input[name=code]").value="https://www.youtube.com/watch?v=7CcEYRfxUOQ",simulateEvent("submit",0,t.querySelector(".jodit_form")),expect(sortAtrtibutes(e.value)).to.equal('<iframe allowfullscreen="" frameborder="0" height="345" src="https://www.youtube.com/embed/7CcEYRfxUOQ" width="400"></iframe>'),simulateEvent("mousedown",0,e.editor),expect(t.parentNode).to.equal(null)}),it("Open align list and choose Right align.",function(){var e=new Jodit(appendTestArea());e.setEditorValue("Test"),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-left"));var t=e.container.querySelector(".jodit_toolbar_list");expect(window.getComputedStyle(t).display).to.equal("block"),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-left .jodit_toolbar_btn.jodit_toolbar_btn-right")),expect(sortAtrtibutes(e.getEditorValue())).to.equal('<p style="text-align:right">Test</p>'),simulateEvent("mousedown",0,e.editor),expect(t.parentNode).to.equal(null)}),describe("Click inside the link",function(){it("Should open link popup",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('test test <a href="#">test</a>'),simulateEvent("mousedown",0,e.editor.querySelector("a"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline.jodit_toolbar_popup-inline-open[data-editor_id="+e.id+"]");expect(t).to.be.not.equal(null)}),describe("Click on pencil",function(){it("Should open edit link popup",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('test test <a href="#">test</a>'),simulateEvent("mousedown",0,e.editor.querySelector("a"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline[data-editor_id="+e.id+"]");expect(t).to.be.not.equal(null),expect(t.classList.contains("jodit_toolbar_popup-inline-open")).to.be.equal(!0);var o=t.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link a");expect(o).to.be.not.equal(null),simulateEvent("mousedown",0,o);var n=t.querySelector(".jodit_toolbar_popup");expect(n).to.be.not.equal(null),expect(n.style.display).to.be.equal("block"),expect(t.classList.contains("jodit_toolbar_popup-inline-open")).to.be.equal(!0),expect(t.parentNode.parentNode.parentNode).to.be.not.equal(null)})})}),describe("Open LINK insert dialog and insert new link",function(){it("Should insert new link",function(){var e=0,t=new Jodit(appendTestArea(),{events:{beforeLinkOpenPopup:function(){e+=1},afterLinkOpenPopup:function(){e+=1}},observer:{timeout:0}});t.value="",simulateEvent("mousedown",0,t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link"));var o=t.container.querySelector(".jodit_toolbar_popup");expect(e).to.be.equal(2),expect(t.ownerWindow.getComputedStyle(o).display).to.equal("block"),expect(t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_unlink_button").style.display).to.equal("none");var n=t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link input[name=url]");expect(n).to.be.not.equal(null),n.focus(),n.value="",t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link input[name=text]").value="123",simulateEvent("submit",0,t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_form")),expect(n.classList.contains("jodit_error")).to.be["true"],n.focus(),n.value="tests/artio.jpg",simulateEvent("submit",0,t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_form")),expect(sortAtrtibutes(t.value)).to.equal('<a href="tests/artio.jpg">123</a>'),simulateEvent("mousedown",0,t.editor),expect(o.parentNode).to.equal(null)}),describe("On selected text",function(){it("Should wrap selected text in link",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,observer:{timeout:0}});e.value="test <span>select</span> stop";var t=e.editorDocument.createRange();t.selectNodeContents(e.editor.querySelector("span")),e.selection.selectRange(t),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link"));var o=e.container.querySelector(".jodit_toolbar_popup");expect(o).to.be.not.equal(null),expect(e.ownerWindow.getComputedStyle(o).display).to.equal("block"),expect(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_unlink_button").style.display).to.equal("none");var n=o.querySelector("input[name=url]");expect(n).to.be.not.equal(null);var i=o.querySelector("input[name=text]");expect(i).to.be.not.equal(null),expect(i.value).to.be.equal("select"),n.focus(),n.value="tests/artio.jpg",simulateEvent("submit",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_form")),expect(sortAtrtibutes(e.value)).to.equal('test <a href="tests/artio.jpg">select</a> stop'),simulateEvent("mousedown",0,e.editor),expect(o.parentNode).to.equal(null)})}),it("Should restore source text after user clicked on Unlink button",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('<a target="_blank" rel="nofollow" href="#test">test</a>');var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.selectNode(e.editor.firstChild),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link")),expect(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link input[name=url]").value).to.equal("#test"),expect(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link input[name=target]").checked).to.equal(!0),expect(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link input[name=nofollow]").checked).to.equal(!0),expect(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_unlink_button").style.display).to.be.not.equal("none"),expect(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_link_insert_button").innerHTML).to.equal(e.i18n("Update")),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-link .jodit_unlink_button")),expect(sortAtrtibutes(e.getEditorValue())).to.equal("test")})}),describe("Create table",function(){describe("Mouse move",function(){it("Should highlight cells in table-creator",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-table"));var t=e.container.querySelector(".jodit_toolbar_popup");expect(window.getComputedStyle(t).display).to.equal("block"),simulateEvent("mousemove",0,t.querySelectorAll(".jodit_form-container div")[14]),expect(t.querySelectorAll(".jodit_form-container div.hovered").length).to.equal(10)})})})}),describe("Buttons",function(){describe("Text mode",function(){it("Should work i18n",function(){var e=new Jodit(appendTestArea(),{textIcons:!0,language:"ru"}),t=new Jodit(appendTestArea(),{textIcons:!0,language:"en"}),o=e.container.querySelector(".jodit_toolbar_btn-source").innerText,n=t.container.querySelector(".jodit_toolbar_btn-source").innerText;expect(o).to.be.not.equal(n)}),it("Should create buttons with text",function(){var e=new Jodit(appendTestArea(),{textIcons:!0});expect(e.container.querySelectorAll(".jodit_toolbar_btn-source").length).to.be.equal(1),expect(e.container.querySelectorAll(".jodit_toolbar_btn-source svg").length).to.be.equal(0)}),it("Should add jodit_text_icons class to editor's container",function(){var e=new Jodit(appendTestArea(),{textIcons:!0});expect(e.container.classList.contains("jodit_text_icons")).to.be["true"]}),it("Should set font-size more them 0",function(){var e=new Jodit(appendTestArea(),{textIcons:!0});expect(parseInt(e.ownerWindow.getComputedStyle(e.container.querySelector(".jodit_toolbar_btn-source .jodit_icon")).fontSize,10)).to.be.above(10)}),describe("In tabs",function(){it("Should be also only text",function(){var e=new Jodit(appendTestArea(),{textIcons:!0});expect(e.container.querySelector(".jodit_toolbar_btn-image")).to.be.not.equal(null),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-image"));var t=e.container.querySelector(".jodit_toolbar_btn-image .jodit_toolbar_popup.jodit_toolbar_popup-open");expect(t).to.be.not.equal(null),expect(t.querySelectorAll("svg, img").length).to.be.equal(0)})}),describe("In brush popup",function(){it("Should be also only text",function(){var e=new Jodit(appendTestArea(),{textIcons:!0});expect(e.container.querySelector(".jodit_toolbar_btn-brush")).to.be.not.equal(null),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-brush"));var t=e.container.querySelector(".jodit_toolbar_btn-brush .jodit_toolbar_popup.jodit_toolbar_popup-open");expect(t).to.be.not.equal(null),expect(t.querySelectorAll("svg, img").length).to.be.equal(0)})}),describe("In video popup",function(){it("Should be also only text",function(){var e=new Jodit(appendTestArea(),{textIcons:!0,toolbarAdaptive:!1});expect(e.container.querySelector(".jodit_toolbar_btn-video")).to.be.not.equal(null),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-video"));var t=e.container.querySelector(".jodit_toolbar_btn-video .jodit_toolbar_popup.jodit_toolbar_popup-open");expect(t).to.be.not.equal(null),expect(t.querySelectorAll("svg, img").length).to.be.equal(0)})})}),it("Remove default buttons functionality",function(){var e=new Jodit(appendTestArea());expect(e.container.querySelectorAll(".jodit_toolbar_btn-source").length).to.equal(1),e.destruct(),e=new Jodit(appendTestArea(),{removeButtons:["source"]}),expect(e.container.querySelectorAll(".jodit_toolbar_btn-source").length).to.equal(0)}),it("Add own button",function(){var e=new Jodit(appendTestArea(),{disablePlugins:["mobile"],buttons:Jodit.defaultOptions.buttons.concat([{name:"insertDate",iconURL:"http://xdsoft.net/jodit/images/logo.png",exec:function(e){e.selection.insertHTML(new Date("2016/03/16").toDateString())}}])});expect(e.container.querySelectorAll(".jodit_toolbar_btn-insertDate").length).to.equal(1),e.setEditorValue(""),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-insertDate")),expect(e.getEditorValue()).to.equal("Wed Mar 16 2016")}),it("When cursor inside STRONG tag, Bold button should be selected",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("<strong>test</strong><em>test2</em><i>test3</i><b>test3</b>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,2),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.editor),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_active").length).to.equal(1),o.setStart(e.editor.firstChild.nextSibling.firstChild,2),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.editor),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_active").length).to.equal(0),expect(e.container.querySelectorAll(".jodit_toolbar_btn-italic.jodit_active").length).to.equal(1),o.setStart(e.editor.firstChild.nextSibling.nextSibling.firstChild,2),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.editor),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_active").length).to.equal(0),expect(e.container.querySelectorAll(".jodit_toolbar_btn-italic.jodit_active").length).to.equal(1),o.setStart(e.editor.firstChild.nextSibling.nextSibling.nextSibling.firstChild,2),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.editor),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_active").length).to.equal(1),expect(e.container.querySelectorAll(".jodit_toolbar_btn-italic.jodit_active").length).to.equal(0)}),describe("Disable for mode",function(){it("Should disable buttons which can not be used in that mode",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("<strong>test</strong><em>test2</em><i>test3</i><b>test3</b>"),e.setMode(Jodit.MODE_SOURCE),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_disabled").length).to.equal(1),expect(e.container.querySelectorAll(".jodit_toolbar_btn-source.jodit_disabled").length).to.equal(0),e.setMode(Jodit.MODE_WYSIWYG),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_disabled").length).to.equal(0),expect(e.container.querySelectorAll(".jodit_toolbar_btn-source.jodit_disabled").length).to.equal(0)}),describe("For list",function(){describe("enable",function(){it("Should enable buttons which can be used in that mode",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0},defaultMode:Jodit.MODE_SOURCE,buttons:[{name:"list_test",mode:Jodit.MODE_SPLIT,list:{h1:"insert Header 1",h2:"insert Header 2",clear:"Empty editor"},exec:function(e){var t=this.args[0];this.args[1];"clear"!==t?e.selection.insertHTML("&nbsp;{{test"+t+"}}&nbsp;"):this.val("")},template:function(e,t){return"<div>"+t+"</div>"}}]}).container.querySelector(".jodit_toolbar_btn-list_test");expect(e).to.be.not["null"],expect(e.classList.contains("jodit_disabled")).to.be["false"],simulateEvent("mousedown",0,e);var t=e.querySelector(".jodit_toolbar_list");expect(t).to.be.not["null"],expect(t.querySelectorAll(".jodit_disabled").length).to.be.equal(0)})}),describe("disable",function(){it("Should disable buttons which can not be used in that mode",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0},defaultMode:Jodit.MODE_SOURCE,buttons:[{name:"list_test",mode:Jodit.MODE_WYSIWYG,list:{h1:"insert Header 1",h2:"insert Header 2",clear:"Empty editor"},exec:function(e){var t=this.args[0];this.args[1];"clear"!==t?e.selection.insertHTML("&nbsp;{{test"+t+"}}&nbsp;"):this.val("")},template:function(e,t){return"<div>"+t+"</div>"}}]}).container.querySelector(".jodit_toolbar_btn-list_test");expect(e).to.be.not["null"],expect(e.classList.contains("jodit_disabled")).to.be["true"],simulateEvent("mousedown",0,e);var t=e.querySelector(".jodit_toolbar_list");expect(t).to.be["null"]})})})}),it('When cursor inside SPAN tag with style="font-weight: bold" or style="font-weight: 700", Bold button should be selected',function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('<span style="font-weight: bold">test</span>');var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,2),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.editor),expect(e.container.querySelectorAll(".jodit_toolbar_btn-bold.jodit_active").length).to.equal(1)}),describe("Check Redo Undo functionality",function(){it("Should change disable in icon then then can not be executed",function(){var e=appendTestArea();e.value="top";var t=new Jodit(e,{observer:{timeout:0}});t.selection.focus(),t.value="Test",expect(t.container.querySelectorAll(".jodit_toolbar_btn-undo.jodit_disabled").length).to.equal(0),expect(t.container.querySelectorAll(".jodit_toolbar_btn-redo.jodit_disabled").length).to.equal(1),simulateEvent("mousedown",0,t.container.querySelector(".jodit_toolbar_btn-undo")),expect(t.container.querySelectorAll(".jodit_toolbar_btn-undo.jodit_disabled").length).to.equal(1),expect(t.container.querySelectorAll(".jodit_toolbar_btn-redo.jodit_disabled").length).to.equal(0),expect(t.value).to.equal("top")})}),it("Full size button",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-fullsize"));for(var t=e.container.parentNode;t&&!(t instanceof Document);)expect(t.classList.contains("jodit_fullsize_box")).to.equal(!0),t=t.parentNode}),it("Should add extra buttons",function(){var e=new Jodit(appendTestArea(),{extraButtons:[{name:"adddate",exec:function(e){var t=e.editorDocument.createTextNode("111");e.selection.insertNode(t)}}]});e.setEditorValue(""),expect(e.container.querySelectorAll(".jodit_toolbar_btn-adddate").length).to.equal(1),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-adddate")),expect(e.getEditorValue()).to.equal("111")}),describe("Add button",function(){it("Should create buttons in toolbar",function(){var e=new Jodit(appendTestArea(),{buttons:["indent","outdent","bold","customxxx"],disablePlugins:"mobile"});expect(null).to.be.not.equal(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-indent")),expect(null).to.be.not.equal(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-outdent")),expect(null).to.be.not.equal(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-bold")),expect(null).to.be.not.equal(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-customxxx")),expect(null).to.be.equal(e.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-source"))})}),describe("Button Bold",function(){it("Should reactivate Bold button after second click and move cursor out of Strong element",function(){var e=new Jodit(appendTestArea(),{buttons:["bold"]});e.setEditorValue("<p>test</p>"),e.selection.setCursorAfter(e.editor.firstChild.firstChild),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-bold")),e.selection.insertHTML("text"),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-bold")),e.selection.insertHTML("text"),expect(e.getEditorValue()).to.equal("<p>test<strong>text</strong>text</p>")})}),describe("Active button",function(){it("Should not be activated then element has default style",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("<p>test<strong>bold</strong></p>");var t=e.editor.firstChild;e.selection.setCursorAfter(t.firstChild),simulateEvent("mousedown",0,t);var o=e.container.querySelector(".jodit_toolbar_btn-bold"),n=e.container.querySelector(".jodit_toolbar_btn-left");expect(!1).to.equal(n.classList.contains("jodit_active")),expect(!1).to.equal(o.classList.contains("jodit_active")),e.selection.setCursorIn(t.querySelector("strong").firstChild),simulateEvent("mousedown",0,t),expect(!1).to.equal(n.classList.contains("jodit_active")),expect(!0).to.equal(o.classList.contains("jodit_active")),t.style.textAlign="right",simulateEvent("mousedown",0,t),expect(!0).to.equal(n.classList.contains("jodit_active")),expect(!0).to.equal(o.classList.contains("jodit_active"))}),describe("Fontsize button",function(){it("Should be activated then element has no default font-size",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('<p>test<span style="font-size: 12px">bold</span></p>');var t=e.editor.firstChild,o=e.container.querySelector(".jodit_toolbar_btn-fontsize");e.selection.setCursorAfter(t.firstChild),simulateEvent("mousedown",0,t),expect(!1).to.equal(o.classList.contains("jodit_active")),e.selection.setCursorIn(t.lastChild),simulateEvent("mousedown",0,t),expect(!0).to.equal(o.classList.contains("jodit_active"))})}),describe("Color button",function(){it("Should be activated then element has some color",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('<p>test<span style="color: #ccc">bold</span></p>');var t=e.editor.firstChild,o=e.container.querySelector(".jodit_toolbar_btn-brush"),n=e.container.querySelector(".jodit_toolbar_btn-brush svg");e.selection.setCursorAfter(t.firstChild),simulateEvent("mousedown",0,t),expect(!1).to.equal(o.classList.contains("jodit_active")),expect("").to.equal(n.style.fill),e.selection.setCursorIn(t.lastChild),simulateEvent("mousedown",0,t),expect(!0).to.equal(o.classList.contains("jodit_active")),expect("rgb(204, 204, 204)").to.equal(n.style.fill)})}),describe("In list",function(){describe("Fontsize button",function(){it("Should be activated then element has some style value",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue('<p>test<span style="font-size: 16px">bold</span></p>');var t=e.editor.firstChild,o=e.container.querySelector(".jodit_toolbar_btn-fontsize");expect(null).to.be.not.equal(o),e.selection.setCursorAfter(t.firstChild),simulateEvent("mousedown",0,t),expect(!1).to.equal(o.classList.contains("jodit_active")),e.selection.setCursorIn(t.lastChild),simulateEvent("mousedown",0,t),expect(!0).to.equal(o.classList.contains("jodit_active")),simulateEvent("mousedown",0,o);var n=o.querySelector(".jodit_toolbar_btn-6");expect(!0).to.equal(n.classList.contains("jodit_active"))})}),describe("Font family button",function(){it("Should be activated then element has some style value",function(){
var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,observer:{timeout:0}});e.setEditorValue('<p>test<span style="font-family: Georgia, serif;">bold</span></p>');var t=e.editor.firstChild,o=e.container.querySelector(".jodit_toolbar_btn-font");expect(null).to.be.not.equal(o),e.selection.setCursorAfter(t.firstChild),simulateEvent("mousedown",0,t),expect(!1).to.equal(o.classList.contains("jodit_active")),e.selection.setCursorIn(t.lastChild),simulateEvent("mousedown",0,t),expect(!0).to.equal(o.classList.contains("jodit_active")),simulateEvent("mousedown",0,o);var n=o.querySelector(".jodit_toolbar_btn-Georgia_serif");expect(n).to.be.not.equal(o),expect(!0).to.equal(n.classList.contains("jodit_active"))})}),describe("Format block button",function(){it("Should be activated then element has some tagname",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.setEditorValue("<p>test</p><h1>test</h1><code>test</code>");var t=e.editor.firstChild,o=e.container.querySelector(".jodit_toolbar_btn-paragraph");expect(null).to.be.not.equal(o),e.selection.setCursorAfter(t.firstChild),simulateEvent("mousedown",0,t),expect(!1).to.equal(o.classList.contains("jodit_active")),e.selection.setCursorIn(e.editor.childNodes[1]),simulateEvent("mousedown",0,t),expect(!0).to.equal(o.classList.contains("jodit_active")),simulateEvent("mousedown",0,o);var n=o.querySelector(".jodit_toolbar_btn-h1");expect(!0).to.equal(n.classList.contains("jodit_active"))})})}),describe("Select text with several properties",function(){it("Should select all buttons with conditions",function(){var e=new Jodit(appendTestArea(),{observer:{timeout:0}});e.value="<em><strong><u>bold</u></strong></em>";var t=e.editorDocument.createRange();t.setStartBefore(e.editor.firstChild),t.setEndAfter(e.editor.firstChild),e.selection.selectRange(t);var o=e.container.querySelector(".jodit_toolbar_btn-bold"),n=e.container.querySelector(".jodit_toolbar_btn-italic"),i=e.container.querySelector(".jodit_toolbar_btn-underline");expect(!0).to.be.equal(o.classList.contains("jodit_active")),expect(!0).to.be.equal(n.classList.contains("jodit_active")),expect(!0).to.be.equal(i.classList.contains("jodit_active"))})})}),describe("Disable button",function(){describe("Cut",function(){it("Should be activated editor has some selected text",function(){var e=new Jodit(appendTestArea(),{toolbarAdaptive:!1,observer:{timeout:0}}),t=e.container.querySelector(".jodit_toolbar_btn-cut");e.setEditorValue("<p>test<strong>bold</strong></p>"),expect(!0).to.equal(t.classList.contains("jodit_disabled"));var o=e.editor.firstChild;e.selection.select(o.firstChild),expect(!1).to.equal(t.classList.contains("jodit_disabled"))})})})}),describe("Commands",function(){it("Click on Source button should change current mode",function(){var e=new Jodit(appendTestArea());simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-source")),expect(e.getMode()).to.equal(Jodit.MODE_SOURCE)}),it("Click on Bold button should wrap current selection in <strong>",function(){var e=new Jodit(appendTestArea());e.setEditorValue("Text to text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,3),o.setEnd(e.editor.firstChild,10),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-bold")),expect(e.getEditorValue()).to.equal("Tex<strong>t to te</strong>xt")}),it("Click on Italic button when selection is collapsed should create new <em> element and set cursor into it",function(){var e=new Jodit(appendTestArea());e.setEditorValue("Text to text");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild,0),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-italic")),e.selection.insertHTML("test"),expect(e.getEditorValue()).to.equal("<em>test</em>Text to text")}),it("Click on unordered list button when selection is collapsed should wrap current box in  new <ul><li> element",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<p>Text to text</p>");var t=e.editorWindow.getSelection(),o=e.editorDocument.createRange();o.setStart(e.editor.firstChild.firstChild,5),o.collapse(!0),t.removeAllRanges(),t.addRange(o),simulateEvent("mousedown",0,e.container.querySelector(".jodit_toolbar_btn-ul")),e.selection.insertHTML("test "),expect(e.getEditorValue()).to.equal("<ul><li>Text test to text</li></ul>")})}),describe("Inline",function(){describe("\u0421lick on the image",function(){it("Should Open inline popup",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<img src="/tests/artio.jpg"/>'),simulateEvent("mousedown",0,e.editor.querySelector("img"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(t&&null!==t.parentNode.parentNode).to.equal(!0)}),describe("and click in opened popup on pencil button",function(){it("Should Open edit image dialog",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<img src="/tests/artio.jpg"/>'),simulateEvent("mousedown",0,e.editor.querySelector("img"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(t&&null!==t.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,t.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-pencil"));var o=e.ownerDocument.querySelector(".jodit.jodit_dialog_box.active[data-editor_id="+e.id+"]");expect(o).to.be.not.equal(null)})})}),it("Open inline popup after click inside the cell",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>1</td></tr></table>"),simulateEvent("mousedown",0,e.editor.querySelector("td"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(t&&null!==t.parentNode.parentNode).to.equal(!0)}),describe("Table button",function(){describe("Select table cell",function(){it("Should Select table cell",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>2</td></tr></table>");var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t),expect(t.hasAttribute(Jodit.JODIT_SELECTED_CELL_MARKER)).to.equal(!0)}),describe("and press brushh button",function(){it("Should Select table cell and fill it in yellow",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>3</td></tr></table>");var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t),simulateEvent("mousemove",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(o&&null!==o.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-brush>a"));var n=o.querySelector(".jodit_toolbar_popup");expect(n&&window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,n.querySelector(".jodit_colorpicker_group>a")),expect(e.helper.normalizeColor(t.style.backgroundColor)).to.equal("#000000")})})})}),it("Select table cell and change it vertical align",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<table><tr><td style="vertical-align: middle">3</td></tr></table>');var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(o&&null!==o.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-valign>a"));var n=o.querySelector(".jodit_toolbar_list");expect(n&&window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,n.querySelector("li>a")),expect(t.style.verticalAlign).to.equal("top")}),it("Select table cell and split it by vertical",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<table style="width: 300px;"><tr><td>3</td></tr></table>');var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-splitv>a"));var n=o.querySelector(".jodit_toolbar_list.jodit_toolbar_list-open");expect(n).to.be.not.equal(null),simulateEvent("mousedown",0,n.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-tablesplitv a")),expect(sortAtrtibutes(e.getEditorValue())).to.equal('<table style="width:300px"><tbody><tr><td style="width:49.83%">3</td><td style="width:49.83%"><br></td></tr></tbody></table>')}),it("Select table cell and split it by horizontal",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<table style="width: 300px;"><tr><td>5</td></tr></table>');var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-splitv>a"));var n=o.querySelector(".jodit_toolbar_list.jodit_toolbar_list-open");expect(n).to.be.not.equal(null),simulateEvent("mousedown",0,n.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-tablesplitg a")),expect(sortAtrtibutes(e.getEditorValue())).to.equal('<table style="width:300px"><tbody><tr><td>5</td></tr><tr><td><br></td></tr></tbody></table>')}),it("Select two table cells and merge then in one",function(){var e=new Jodit(appendTestArea());e.setEditorValue('<table style="width: 300px;"><tr><td>5</td><td>6</td></tr></table>');var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t),simulateEvent("mousemove",0,e.editor.querySelectorAll("td")[1]);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-merge>a")),expect(e.getEditorValue()).to.equal('<table style="width: 300px;"><tbody><tr><td >5<br>6</td></tr></tbody></table>')}),it("Select table cell add column before this",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>3</td></tr></table>");var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(o&&null!==o.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-addcolumn>a"));var n=o.querySelector(".jodit_toolbar_list");expect(n&&window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,n.querySelector("li>a")),expect(e.getEditorValue()).to.equal("<table><tbody><tr><td></td><td >3</td></tr></tbody></table>")}),it("Select table cell and add row above this",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>3</td></tr></table>");var t=e.editor.querySelector("td");simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(o&&null!==o.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-addrow>a"));var n=o.querySelector(".jodit_toolbar_list");expect(n&&window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,n.querySelector("li>a")),expect(e.getEditorValue()).to.equal("<table><tbody><tr><td></td></tr><tr><td >3</td></tr></tbody></table>")}),it("Select table cell and remove it row",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>1</td></tr><tr><td>2</td></tr><tr><td>3</td></tr></table>");var t=e.editor.querySelectorAll("td")[1];simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(o&&null!==o.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-bin>a"));var n=o.querySelector(".jodit_toolbar_list");expect(n&&window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,n.querySelectorAll("li>a")[1]),expect(e.getEditorValue()).to.equal("<table><tbody><tr><td>1</td></tr><tr><td>3</td></tr></tbody></table>")}),it("Select table cell and remove whole table should hide inline popup",function(){var e=new Jodit(appendTestArea());e.setEditorValue("<table><tr><td>1</td></tr><tr><td>2</td></tr><tr><td>3</td></tr></table>");var t=e.editor.querySelectorAll("td")[1];simulateEvent("mousedown",0,t);var o=e.ownerDocument.querySelector(".jodit_toolbar_popup-inline");expect(o&&null!==o.parentNode.parentNode).to.equal(!0),simulateEvent("mousedown",0,o.querySelector(".jodit_toolbar_btn-bin>a"));var n=o.querySelector(".jodit_toolbar_list");expect(n&&window.getComputedStyle(n).display).to.equal("block"),simulateEvent("mousedown",0,n.querySelectorAll("li>a")[0]),expect(e.getEditorValue()).to.equal(""),expect(o&&null!==o.parentNode.parentNode).to.equal(!0)})}),describe("In fileBrowser",function(){describe("Hide buttons ",function(){it("should hide toolbar buttons",function(){var e=new Jodit(appendTestArea(),{filebrowser:{buttons:Jodit.Array(["filebrowser.list","filebrowser.tiles","filebrowser.sort"]),ajax:{url:"https://xdsoft.net/jodit/connector/index.php"}}});simulateEvent("mousedown",0,e.ownerDocument.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-image"));var t=e.ownerDocument.querySelector(".jodit_toolbar_popup");expect(t&&"none"!==t.style.display).to.equal(!0),simulateEvent("mousedown",0,t.querySelectorAll(".jodit_tabs_buttons > a")[0]);var o=e.ownerDocument.querySelector(".jodit.jodit_dialog_box.active[data-editor_id="+e.id+"]");expect(o).to.be.not.equal(null),expect(3).to.equal(o.querySelectorAll(".jodit_dialog_header .jodit_dialog_header-title .jodit_toolbar_btn").length)})})})}),describe("About dialog",function(){it("Should conteins License element",function(){var e=appendTestArea(),t=new Jodit(e,{license:"111",toolbarAdaptive:!1}),o=t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-about");expect(o).to.be.not.equal(null),simulateEvent("mousedown",0,o);var n=t.ownerDocument.querySelector(".jodit.jodit_dialog_box.active[data-editor_id="+e.id+"]");expect(n).to.be.not.equal(null),expect(n.innerText.match(/License:.*(GPL|GNU)/)).to.be.not.equal(null)}),describe("Set license",function(){it("Should show License in about dialog",function(){var e=appendTestArea(),t=new Jodit(e,{license:"12345678901234567890123456789022",toolbarAdaptive:!1}),o=t.container.querySelector(".jodit_toolbar_btn.jodit_toolbar_btn-about");expect(o).to.be.not.equal(null),simulateEvent("mousedown",0,o);var n=t.ownerDocument.querySelector(".jodit.jodit_dialog_box.active[data-editor_id="+e.id+"]");expect(n).to.be.not.equal(null),expect(n.innerText.match(/License:.*(GPL|GNU)/)).to.be.equal(null),expect(n.innerText.match(/License: 12345678-\*\*\*\*\*\*\*\*-\*\*\*\*\*\*\*\*-56789022/)).to.be.not.equal(null)})})}),afterEach(removeStuff)});